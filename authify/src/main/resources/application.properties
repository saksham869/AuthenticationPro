# =============================================
# DATABASE CONFIGURATION
# =============================================
spring.datasource.url=jdbc:mysql://localhost:3306/authify_app?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
spring.datasource.username=${DB_USERNAME}
spring.datasource.password=${DB_PASSWORD}
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# HikariCP Connection Pool (good defaults for dev/small prod)
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=20000
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.max-lifetime=1200000

# JPA / Hibernate
spring.jpa.hibernate.ddl-auto=update        # dev: update, prod: change to validate
spring.jpa.show-sql=false                   # true only if you want to see queries
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true


# =============================================
# JWT CONFIGURATION
# =============================================
# Store this in environment variable: export JWT_SECRET_KEY="base64-encoded-256-bit-key"
jwt.secret.key=${JWT_SECRET_KEY}

# 1 hour access token, 7 days refresh token
jwt.expiration.ms=3600000
jwt.refresh.expiration.ms=604800000
jwt.algorithm=HS256


# =============================================
# EMAIL CONFIGURATION (BREVO SMTP)
# =============================================
spring.mail.host=smtp-relay.brevo.com
spring.mail.port=587
spring.mail.username=${SMTP_USERNAME}       # Brevo SMTP login (NOT API key)
spring.mail.password=${SMTP_API_KEY}        # Brevo SMTP password/key
spring.mail.protocol=smtp
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.properties.mail.smtp.connectiontimeout=5000
spring.mail.properties.mail.smtp.timeout=5000
spring.mail.properties.mail.smtp.writetimeout=5000
spring.mail.properties.mail.smtp.from=${MAIL_FROM_ADDRESS}

mail.from.name=Authify
mail.from.email=${MAIL_FROM_ADDRESS}


# =============================================
# SERVER CONFIGURATION
# =============================================
server.servlet.context-path=/api/v1.0
server.port=8080

# Cookies & session (stateless JWT, but good defaults)
server.servlet.session.timeout=30m
server.servlet.session.cookie.secure=true
server.servlet.session.cookie.http-only=true
server.servlet.session.cookie.same-site=strict


# =============================================
# LOGGING CONFIGURATION
# =============================================
logging.level.root=INFO
logging.level.com.authify=DEBUG
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %logger{36} - %msg%n

# Optional file logging
# logging.file.name=logs/authify.log
# logging.logback.rollingpolicy.max-file-size=10MB
# logging.logback.rollingpolicy.max-history=30


# =============================================
# PERFORMANCE / COMPRESSION
# =============================================
server.compression.enabled=true
server.compression.min-response-size=1024
server.compression.excluded-media-types=image/jpeg,image/png,video/mp4


# =============================================
# ACTUATOR (OPTIONAL: HEALTH & METRICS)
# =============================================
# management.endpoints.web.exposure.include=health,metrics,info
# management.endpoint.health.show-details=when-authorized
